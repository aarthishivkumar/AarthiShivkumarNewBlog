{
  "hash": "5ee7422bb740f1f8be4e9258caf8437e",
  "result": {
    "markdown": "---\ntitle: \"Sleep quality analysis\"\nauthor: \"Aarthi Shivkumar\"\ndate: \"2023-11-09\"\ncategories: [sleep, data science]\nimage: \"image.jpg\"\n---\n\n\nIn this exploration, we're going to take a closer look at the factors that influence sleep quality, such as the proportion of deep and REM sleep, as well as the percentage of light sleep. My personal challenges with maintaining consistent sleep patterns have led me to investigate this topic more deeply. For this analysis, I've selected a comprehensive dataset available on Kaggle, which provides valuable insights into sleep efficiency. You can access the dataset [here](https://www.kaggle.com/datasets/equilibriumm/sleep-efficiency) to follow along or conduct your own exploration: https://www.kaggle.com/datasets/equilibriumm/sleep-efficiency.\n\nFirst, let us import the dataset from Kaggle as such.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nsleep_data <- read.csv(\"Sleep_Efficiency.csv\")\n```\n:::\n\n\nNext, we will find the summary of each variable. For instance, we can see that the mean sleep efficiency is -.7889, and the median is 0.8200, which is fairly high but can be further improved.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(sleep_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       ID             Age           Gender            Bedtime         \n Min.   :  1.0   Min.   : 9.00   Length:452         Length:452        \n 1st Qu.:113.8   1st Qu.:29.00   Class :character   Class :character  \n Median :226.5   Median :40.00   Mode  :character   Mode  :character  \n Mean   :226.5   Mean   :40.29                                        \n 3rd Qu.:339.2   3rd Qu.:52.00                                        \n Max.   :452.0   Max.   :69.00                                        \n                                                                      \n Wakeup.time        Sleep.duration   Sleep.efficiency REM.sleep.percentage\n Length:452         Min.   : 5.000   Min.   :0.5000   Min.   :15.00       \n Class :character   1st Qu.: 7.000   1st Qu.:0.6975   1st Qu.:20.00       \n Mode  :character   Median : 7.500   Median :0.8200   Median :22.00       \n                    Mean   : 7.466   Mean   :0.7889   Mean   :22.62       \n                    3rd Qu.: 8.000   3rd Qu.:0.9000   3rd Qu.:25.00       \n                    Max.   :10.000   Max.   :0.9900   Max.   :30.00       \n                                                                          \n Deep.sleep.percentage Light.sleep.percentage   Awakenings   \n Min.   :18.00         Min.   : 7.00          Min.   :0.000  \n 1st Qu.:48.25         1st Qu.:15.00          1st Qu.:1.000  \n Median :58.00         Median :18.00          Median :1.000  \n Mean   :52.82         Mean   :24.56          Mean   :1.641  \n 3rd Qu.:63.00         3rd Qu.:32.50          3rd Qu.:3.000  \n Max.   :75.00         Max.   :63.00          Max.   :4.000  \n                                              NA's   :20     \n Caffeine.consumption Alcohol.consumption Smoking.status     Exercise.frequency\n Min.   :  0.00       Min.   :0.000       Length:452         Min.   :0.000     \n 1st Qu.:  0.00       1st Qu.:0.000       Class :character   1st Qu.:0.000     \n Median : 25.00       Median :0.000       Mode  :character   Median :2.000     \n Mean   : 23.65       Mean   :1.174                          Mean   :1.791     \n 3rd Qu.: 50.00       3rd Qu.:2.000                          3rd Qu.:3.000     \n Max.   :200.00       Max.   :5.000                          Max.   :5.000     \n NA's   :25           NA's   :14                             NA's   :6         \n```\n:::\n:::\n\n\nNext, let us analyze the the gender representation in the dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsleep_data_summary <- sleep_data %>%\n  count(Gender) %>%\n  mutate(Percentage = n / sum(n) * 100)\n\n# Create the bar plot with the calculated percentages\nggplot(sleep_data_summary, aes(x = Gender, y = Percentage, fill = Gender)) +\n  geom_bar(stat = \"identity\", fill = \"blue\") +\n  labs(title = \"Gender Distribution as a Percentage\",\n       x = \"Gender\",\n       y = \"Percentage\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nFrom this bar plot above, we can see that males and females are almost equally represented in the dataset. This makes our findings relevant to both genders.\n\nNext, we want to analyze the relationship between REM sleep percentage and sleep efficiency. While deep sleep is crucial for physical restoration and strengthening the immune system, REM sleep is marked by active brain patterns and rapid eye movement despite the body's muscle relaxation. Therefore, I wanted to see which is associated more with sleep efficiency.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_rem <- lm(Sleep.efficiency ~ REM.sleep.percentage, data = sleep_data)\nsummary_rem <- summary(lm_rem) # Capture the model summary for later use\n\n# Plot REM Sleep vs. Sleep Efficiency with correlation line and R² value\nggplot(sleep_data, aes(x = REM.sleep.percentage, y = Sleep.efficiency)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", col = \"blue\") +\n  annotate(\"text\", x = Inf, y = Inf, hjust = 1.1, vjust = 1.1,\n           label = paste(\"R² = \", round(summary_rem$r.squared, 2)),\n           size = 5) +\n  labs(title = \"REM Sleep vs. Sleep Efficiency\",\n       x = \"REM Sleep (%)\",\n       y = \"Sleep Efficiency (%)\") +\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_rem <- lm(Sleep.efficiency ~ Deep.sleep.percentage, data = sleep_data)\nsummary_rem <- summary(lm_rem) # Capture the model summary for later use\n\n# Plot REM Sleep vs. Sleep Efficiency with correlation line and R² value\nggplot(sleep_data, aes(x = Deep.sleep.percentage, y = Sleep.efficiency)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", col = \"blue\") +\n  annotate(\"text\", x = Inf, y = Inf, hjust = 1.1, vjust = 1.1,\n           label = paste(\"R² = \", round(summary_rem$r.squared, 2)),\n           size = 5) +\n  labs(title = \"Deep Sleep vs. Sleep Efficiency\",\n       x = \"Deep Sleep (%)\",\n       y = \"Sleep Efficiency (%)\") +\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nFrom the R\\^2 values and the scatter plots above, we can see that deep sleep has a much higher correlation with sleep efficiency. The higher correlation suggests that as deep sleep increases (or decreases), there is a stronger tendency for sleep efficiency to also increase (or decrease), and this relationship is more consistent for deep sleep than for REM sleep. This could mean that deep sleep might have a more direct or stronger impact on the overall quality of sleep (as measured by efficiency) than REM sleep does.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}